import{u as k,b as C,r as v,c as z,j as f,k as E,d,o as F,e as U,f as r,g as a,w as n,h as q,i as w,n as A,l as B,t as M,E as _}from"./index-3d7d46f8.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";const D={class:"register-container"},T={class:"register-card"},Z={class:"password-strength"},j={class:"strength-meter"},I={class:"strength-text"},L={class:"form-actions"},W={class:"register-footer"},$={__name:"RegisterView",setup(G){const h=k(),b=C(),u=v(!1),t=z({email:"",password:"",confirmPassword:""}),p=f(()=>{const s=t.password;if(!s)return 0;let e=0;s.length>=8&&e++,s.length>=12&&e++;const o=/[a-z]/.test(s),l=/[A-Z]/.test(s),c=/\d/.test(s),g=/[^a-zA-Z0-9]/.test(s);return(o&&l||c&&g)&&e++,o&&l&&c&&g&&e++,Math.min(3,e)}),y=f(()=>{const s=p.value;return s===0?"weak":s===1?"medium":s===2?"strong":"very-strong"}),V=f(()=>`${(p.value+1)*25}%`),S=f(()=>{const s=p.value;return s===0?"弱":s===1?"中":s===2?"强":"非常强"}),P={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,message:"密码长度至少为8个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(s,e,o)=>{e!==t.password?o(new Error("两次输入的密码不一致")):o()},trigger:"blur"}]};E(()=>t.password,()=>{var s;t.confirmPassword&&((s=m.value)==null||s.validateField("confirmPassword"))});const m=v(null),x=async()=>{var s,e;if(m.value)try{if(await m.value.validate(),p.value<2){_.warning("请设置更强的密码");return}u.value=!0,await b.register({email:t.email,password:t.password}),_.success("注册成功"),h.push("/dashboard")}catch(o){console.error("注册失败:",o),_.error(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"注册失败，请稍后重试")}finally{u.value=!1}};return(s,e)=>{const o=d("el-input"),l=d("el-form-item"),c=d("el-button"),g=d("el-form"),R=d("router-link");return F(),U("div",D,[r("div",T,[e[7]||(e[7]=r("div",{class:"register-header"},[r("div",{class:"logo"},"🔒"),r("h1",null,"密码管家"),r("p",null,"创建管理员账号")],-1)),a(g,{ref_key:"registerFormRef",ref:m,model:t,rules:P,"label-position":"top",onSubmit:q(x,["prevent"])},{default:n(()=>[a(l,{label:"邮箱",prop:"email"},{default:n(()=>[a(o,{modelValue:t.email,"onUpdate:modelValue":e[0]||(e[0]=i=>t.email=i),placeholder:"请输入邮箱",type:"email",autocomplete:"email"},null,8,["modelValue"])]),_:1}),a(l,{label:"密码",prop:"password"},{default:n(()=>[a(o,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=i=>t.password=i),placeholder:"请输入密码",type:"password",autocomplete:"new-password","show-password":""},null,8,["modelValue"])]),_:1}),a(l,{label:"确认密码",prop:"confirmPassword"},{default:n(()=>[a(o,{modelValue:t.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=i=>t.confirmPassword=i),placeholder:"请再次输入密码",type:"password",autocomplete:"new-password","show-password":""},null,8,["modelValue"])]),_:1}),r("div",Z,[e[3]||(e[3]=r("div",{class:"strength-label"},"密码强度:",-1)),r("div",j,[r("div",{class:A(["strength-bar",y.value]),style:B({width:V.value})},null,6)]),r("div",I,M(S.value),1)]),r("div",L,[a(c,{type:"primary","native-type":"submit",loading:u.value,disabled:u.value,class:"submit-btn"},{default:n(()=>[...e[4]||(e[4]=[w(" 注册 ",-1)])]),_:1},8,["loading","disabled"])])]),_:1},8,["model"]),r("div",W,[r("p",null,[e[6]||(e[6]=w(" 已有账号？ ",-1)),a(R,{to:"/login"},{default:n(()=>[...e[5]||(e[5]=[w("立即登录",-1)])]),_:1})])])])])}}},O=N($,[["__scopeId","data-v-51b2116a"]]);export{O as default};
